import java.io._
@main def exec(cpgFile: String ,outFile: String) = {
	loadCpg(cpgFile)
	if(cpg.typeDecl.name(".*HttpServlet.*").isEmpty){
   		"no xss" |> outFile
   	}else{
		val methods = cpg.parameter.evalType(".*HttpServlet.*").method.filterNot(_.callIn).name.l

		for(method <- methods){
	
	      		val source = cpg.method.fullName(".*"+method+".*").parameter.evalType(".*HttpServletRequest.*")
	      		val sink = cpg.parameter.evalType(".*PrintWriter.*").argument.evalTypeNot(".*String.*")
	      		try {
       	  			sink.reachableBy(source).flows.p |> outFile
			}
	     
		}
	
   	}
	 
}
